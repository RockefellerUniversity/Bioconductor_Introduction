library(ggplot2)
?geom_smooth
library(ggplot2)
41971998+429884
43292226-890344
41971998+429884
184070964/4
43493770
read.delim("clipboard",sep=" ")
read.delim("clipboard",sep=" ")
read.delim("clipboard",sep=" ")
33064684/4
gc()
tee <- read.delim("~/Projects/Results/SashaT/newBrd4ChIP/Empty.gz",sep="\t",header=T)
tee <- read.delim("~/Projects/Results/SashaT/newBrd4ChIP/Empty.gz",sep="\t",header=T)
tee <- read.delim("~/Projects/Results/SashaT/newBrd4ChIP/Empty.txt",sep="\t",header=T)
tee <- read.delim("~/Projects/Results/SashaT/newBrd4ChIP/Empty.gz",sep="\t",header=T,comment.char = "@")
tee[1:2,]
tee <- read.delim("~/Projects/Results/SashaT/newBrd4ChIP/Empty.gz",sep="\t",header=F,comment.char = "@")
tee[1:2,]
tee <- read.delim("~/Projects/Results/SashaT/newBrd4ChIP/Empty.gz",sep="\t",header=F,comment.char = "@",row.names = 4)
teeMat
tee <- read.delim("~/Projects/Results/SashaT/newBrd4ChIP/Empty.gz",sep="\t",header=F,comment.char = "@",row.names = 4)
tee[1:2,]
teeMat <- tee %>% dplyr::select(-V1,-V2,-V3,V5,-V6) %>% as.matrix
library(tidyverse)
teeMat <- tee %>% dplyr::select(-V1,-V2,-V3,V5,-V6) %>% as.matrix
teeMat
class(teeMat)
plot(colSums(teeMat))
library(GSEABase)
tess <- GSEABase::getGmt("~/Downloads/GO overlap infection ectopic/negative/")
tess
tess <- GSEABase::getGmt("~/Downloads/GO overlap infection ectopic/negative/GO_CELLULAR_AMINO_ACID_CATABOLIC_PROCESS.gmt")
tess <- GSEABase::getGmt("~/Downloads/GO overlap infection ectopic/negative/GO_NEGATIVE_REGULATION_OF_MITOTIC_CELL_CYCLE.gmt")
tess <- GSEABase::getGmt("~/Downloads/GO overlap infection ectopic/negative/GO_NEGATIVE_REGULATION_OF_MITOTIC_CELL_CYCLE.gmt",sep = "\t")
tess <- GSEABase::getGmt("~/Downloads/GO overlap infection ectopic/positive/GO_POSITIVE_REGULATION_OF_CHEMOTAXIS.gmt",sep = "\t")
tess <- GSEABase::getGmt("~/Downloads/GO overlap infection ectopic/positive/GO_POSITIVE_REGULATION_OF_LEUKOCYTE_CHEMOTAXIS.gmt",sep = "\t")
tess <- GSEABase::getGmt("~/Downloads/GO overlap infection ectopic/positive/GO_POSITIVE_REGULATION_OF_LEUKOCYTE_CHEMOTAXIS.gmt",sep = " ")
tess
tess <- GSEABase::getGmt("~/Downloads/GO overlap infection ectopic/negative/",sep=" ")
tess
?GSEABase::getGmt
tess <- GSEABase::getGmt("~/Downloads/GO overlap infection ectopic/negative/",sep=" ",geneIdType=SymbolIdentifier())
tess
library(GSEABase)
gmts <- dir("~/Downloads/GO overlap infection ectopic/",pattern = "*.gmt",recursive = TRUE,full.names = TRUE)
gmts
tess
tess <- GSEABase::getGmt("~/Downloads/GO overlap infection ectopic/positive/GO_POSITIVE_REGULATION_OF_LEUKOCYTE_CHEMOTAXIS.gmt",sep = " ")
tess
geneIds(tess)
tess <- GSEABase::getGmt("~/Downloads/GO overlap infection ectopic/positive/GO_POSITIVE_REGULATION_OF_LEUKOCYTE_CHEMOTAXIS.gmt",sep = "\t")
tess
geneIds(tess)
lapply(gmts,function(x)geneIds(GSEABase::getGmt(x,sep="\t
",geneIdType=SymbolIdentifier()))
chr1	249250621	6986116	0
chr2	243199373	3755800	0
chr3	198022430	3059032	0
chr4	191154276	2910724	0
chr5	180915260	3478571	0
chr6	171115067	2509718	0
chr7	159138663	2995622	0
chr8	146364022	2257870	0
chr9	141213431	2274145	0
chr10	135534747	1989842	0
chr11	135006516	2611662	0
chr12	133851895	2288514	0
chr13	115169878	1153798	0
chr14	107349540	1445497	0
chr15	102531392	1325332	0
chr16	90354753	1626932	0
chr17	81195210	1733051	0
chr18	78077248	1162960	0
chr19	59128983	1519311	0
chr20	63025520	1370995	0
chr21	48129895	524312	0
chr22	51304566	740040	0
chrX	155270560	1130351	0
chrY	59373566	193132	0
chrM	16571	29058343	0
*	0	0	11933812
./bwa index /rugpfs/fs0/ruit/scratch/tcarroll/diegoExtraForEnhancers/ChIPseqRefs/BSgenome.Hsapiens.UCSC.hg19.fa
./bwa aln /rugpfs/fs0/ruit/scratch/tcarroll/diegoExtraForEnhancers/ChIPseqRefs/BSgenome.Hsapiens.UCSC.hg19 /rugpfs/fs0/geno/scratch/shuang/data_4_Tom/Tarakhovsky_lab/Leticia/1_S1_R1_001.fastq.gz
lapply(gmts,function(x)geneIds(GSEABase::getGmt(x,sep="\t
",geneIdType=SymbolIdentifier()))
)
lapply(gmts,function(x)geneIds(GSEABase::getGmt(x,sep="\t",geneIdType=SymbolIdentifier()))
)
test <- lapply(gmts,function(x)geneIds(GSEABase::getGmt(x,sep="\t",geneIdType=SymbolIdentifier()))
chr1	249250621	6986116	0
chr2	243199373	3755800	0
chr3	198022430	3059032	0
chr4	191154276	2910724	0
chr5	180915260	3478571	0
chr6	171115067	2509718	0
chr7	159138663	2995622	0
chr8	146364022	2257870	0
chr9	141213431	2274145	0
chr10	135534747	1989842	0
chr11	135006516	2611662	0
chr12	133851895	2288514	0
chr13	115169878	1153798	0
chr14	107349540	1445497	0
chr15	102531392	1325332	0
chr16	90354753	1626932	0
chr17	81195210	1733051	0
chr18	78077248	1162960	0
chr19	59128983	1519311	0
chr20	63025520	1370995	0
chr21	48129895	524312	0
chr22	51304566	740040	0
chrX	155270560	1130351	0
chrY	59373566	193132	0
chrM	16571	29058343	0
*	0	0	11933812
./bwa index /rugpfs/fs0/ruit/scratch/tcarroll/diegoExtraForEnhancers/ChIPseqRefs/BSgenome.Hsapiens.UCSC.hg19.fa
./bwa aln /rugpfs/fs0/ruit/scratch/tcarroll/diegoExtraForEnhancers/ChIPseqRefs/BSgenome.Hsapiens.UCSC.hg19 /rugpfs/fs0/geno/scratch/shuang/data_4_Tom/Tarakhovsky_lab/Leticia/1_S1_R1_001.fastq.gz
test <- lapply(gmts,function(x)geneIds(GSEABase::getGmt(x,sep="\t",geneIdType=SymbolIdentifier()))
)
test
test[[1]]
test
library(org.Hs.eg.db)
for(i in 1:length(test)){
mget(test[[i]],org.Hs.egSYMBOL2EG)
}
test[[i]]
for(i in 1:length(test)){
mget(test[[i]][[1]],org.Hs.egSYMBOL2EG,ifnotfound = NA)
}
tes <- mget(test[[i]][[1]],org.Hs.egSYMBOL2EG,ifnotfound = NA)
tes
gmts
basename(gmts)
names(tes) <- gsub("\\.gmt","",basename(gmts))
tes
tes <- list()
for(i in 1:length(test)){
tes[[i]] <- unique(unlist(mget(test[[i]][[1]],org.Hs.egSYMBOL2EG,ifnotfound = NA)))
}
tes
gsub("\\.gmt","",basename(gmts))
names(tes) <- gsub("\\.gmt","",basename(gmts))
names(tes)
tes
for(i in 1:length(test)){
plot(colSums(teeMat[rownames(teeMat) %in% tes[[i]],]))
}
colSums(teeMat[rownames(teeMat) %in% tes[[i]],])
data.frame(Sample="Empty",Score=colSums(teeMat[rownames(teeMat) %in% tes[[i]],]))
data.frame(Sample="Empty",Position=1:300,Score=colSums(teeMat[rownames(teeMat) %in% tes[[i]],]))
data.frame(Sample="Empty",Position=1:306,Score=colSums(teeMat[rownames(teeMat) %in% tes[[i]],]))
data.frame(Sample="Empty",Position=1:301,Score=colSums(teeMat[rownames(teeMat) %in% tes[[i]],]))
tee <- read.delim("~/Projects/Results/SashaT/newBrd4ChIP/Empty.gz",sep="\t",header=F,comment.char = "@",row.names = 4)
library(tidyverse)
library(tidyverse)
teeMat <- tee %>% dplyr::select(-V1,-V2,-V3,-V5,-V6) %>% as.matrix
plot(colSums(teeMat))
myTime <- data.frame(Sample="Empty",Position=1:301,Score=colSums(teeMat[rownames(teeMat) %in% tes[[i]],]))
myTime <- data.frame(Sample="Empty",Position=1:300,Score=colSums(teeMat[rownames(teeMat) %in% tes[[i]],]))
myTime
tee2 <- read.delim("~/Projects/Results/SashaT/newBrd4ChIP/WT.gz",sep="\t",header=F,comment.char = "@",row.names = 4)
library(tidyverse)
teeMat2 <- tee2 %>% dplyr::select(-V1,-V2,-V3,-V5,-V6) %>% as.matrix
teeMat2
tre <- rbind(myTime,myTime2)
myTime <- data.frame(Sample="Empty",Position=1:300,Score=colSums(teeMat[rownames(teeMat) %in% tes[[i]],]))
myTime2 <- data.frame(Sample="WT",Position=1:300,Score=colSums(teeMat2[rownames(teeMat2) %in% tes[[i]],]))
tre <- rbind(myTime,myTime2)
ggplot(tre,aes(x=Position,y=Score,colour=Sample))+geom_line()
for(i in 1:length(test)){
myTime <- data.frame(Sample="Empty",Position=1:300,Score=colSums(teeMat[rownames(teeMat) %in% tes[[i]],]))
myTime2 <- data.frame(Sample="WT",Position=1:300,Score=colSums(teeMat2[rownames(teeMat2) %in% tes[[i]],]))
tre <- rbind(myTime,myTime2)
pee <- ggplot(tre,aes(x=Position,y=Score,colour=Sample))+geom_line()
ggsave(pee,filename = file.path("~/Downloads/GO overlap infection ectopic/",paste0(names(tes)[i],".png"))
}
for(i in 1:length(test)){
myTime <- data.frame(Sample="Empty",Position=1:300,Score=colSums(teeMat[rownames(teeMat) %in% tes[[i]],]))
myTime2 <- data.frame(Sample="WT",Position=1:300,Score=colSums(teeMat2[rownames(teeMat2) %in% tes[[i]],]))
tre <- rbind(myTime,myTime2)
pee <- ggplot(tre,aes(x=Position,y=Score,colour=Sample))+geom_line()
ggsave(pee,filename = file.path("~/Downloads/GO overlap infection ectopic/",paste0(names(tes)[i],".png")))
}
for(i in 1:length(test)){
myTime <- data.frame(Sample="Empty",Position=1:300,Score=colMeans(teeMat[rownames(teeMat) %in% tes[[i]],]))
myTime2 <- data.frame(Sample="WT",Position=1:300,Score=colMeans(teeMat2[rownames(teeMat2) %in% tes[[i]],]))
tre <- rbind(myTime,myTime2)
pee <- ggplot(tre,aes(x=Position,y=Score,colour=Sample))+geom_line()
ggsave(pee,filename = file.path("~/Downloads/GO overlap infection ectopic/",paste0(names(tes)[i],".png")))
}
myTime <- data.frame(Sample="Empty",Position=1:300,Score=colMeans(teeMat))
myTime2 <- data.frame(Sample="WT",Position=1:300,Score=colMeans(teeMat2))
tre <- rbind(myTime,myTime2)
pee <- ggplot(tre,aes(x=Position,y=Score,colour=Sample))+geom_line()
ggsave(pee,filename = file.path("~/Downloads/GO overlap infection ectopic/","AllGenes.png")))
myTime <- data.frame(Sample="Empty",Position=1:300,Score=colMeans(teeMat))
myTime2 <- data.frame(Sample="WT",Position=1:300,Score=colMeans(teeMat2))
tre <- rbind(myTime,myTime2)
pee <- ggplot(tre,aes(x=Position,y=Score,colour=Sample))+geom_line()
ggsave(pee,filename = file.path("~/Downloads/GO overlap infection ectopic/","AllGenes.png"))
